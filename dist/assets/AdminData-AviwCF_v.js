import{x as P,z as R,r as i,V as n,S as k}from"./index-u-RSwE93.js";import{a as h}from"./axios-L6U4YIEh.js";const H=P("adminData",()=>{let T=R(),v=i(null),u=i(""),m=i(""),A=i(""),_=i(!1),c=i(null),w=i(null),g=i(null),y=i(null),j=i(!1),F=i(""),r=i([]),s=i(!1),p=()=>{k.fire({icon:"error",title:"عذراً...",text:"حدث خطأ ما!",confirmButtonColor:"#ff0000"})},B=(e,t)=>{if(r.value.length>0){const l=r.value.find(a=>a.id===t);l&&(u.value===""?l.status=e:r.value=r.value.filter(a=>a.id!==t))}},x=e=>{r.value.length>0&&(r.value=r.value.filter(t=>t.id!==e))},D=()=>{let e=n.get("jwt");u.value="",h.get("https://impactstudio.pythonanywhere.com/api/user/list/all/",{withCredentials:!0,headers:{Authorization:`Bearer ${e}`}}).then(t=>{}).catch(t=>{})},z=(e=1,t=25)=>{u.value="",r.value=[],s.value=!0;let l=n.get("jwt");h.get(`https://impactstudio.pythonanywhere.com/api/user/fileslist//?page=${e}&page_size=${t}`,{withCredentials:!0,headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}}).then(a=>{v.value=a.data.count,r.value=a.data.results}).catch(a=>{p()}).finally(()=>{s.value=!1})},o=(e,t,l=1,a=!1)=>{r.value=[],s.value=!0;let $=n.get("jwt"),d=i(null);a?d.value=`https://impactstudio.pythonanywhere.com/api/user/filter_files/?start_date=${e}&end_date=${t}&page=${l}&page_size=25`:d.value=`https://impactstudio.pythonanywhere.com/api/user/filter_files/?filter_param=${e}&filter_value=${t}&page=${l}&page_size=25`,h.get(d.value,{withCredentials:!0,headers:{Authorization:`Bearer ${$}`}}).then(f=>{v.value=f.data.count,r.value=f.data.results}).catch(f=>{p()}).finally(()=>{s.value=!1})},C=(e,t=1)=>{r.value=[],s.value=!0;let l=n.get("jwt");i(null),h.get(`https://impactstudio.pythonanywhere.com/api/user/Search/?type=files&search_val=${e}&page=${t}&page_size=25`,{withCredentials:!0,headers:{Authorization:`Bearer ${l}`}}).then(a=>{v.value=a.data.count,r.value=a.data.results}).catch(a=>{p()}).finally(()=>{s.value=!1})},S=(e,t)=>{let l=n.get("jwt");h.patch("https://impactstudio.pythonanywhere.com/api/user/update_file/"+t+"/",{status:e},{withCredentials:!0,headers:{Authorization:`Bearer ${l}`}}).then(a=>{B(a.data.status,t)}).catch(a=>{p()})},I=(e,t,l,a,$,d,f)=>{let E=n.get("jwt");s.value=!0,h.patch("https://impactstudio.pythonanywhere.com/api/user/update_file/"+m.value+"/",{file_name:e,release_date:t,city:l,source_entity_name:a,author:$,file_type:d,overview:f},{withCredentials:!0,headers:{Authorization:`Bearer ${E}`}}).then(U=>{s.value=!1,k.fire({title:"تم",text:"تم تحديث الملف بنجاح",icon:"success"}).then(N=>{N.isConfirmed&&T.push("/files-list")})}).catch(U=>{s.value=!1,p()})},L=e=>{let t=n.get("jwt");h.delete(`https://impactstudio.pythonanywhere.com/api/user/delete_file/${e}/`,{withCredentials:!0,headers:{Authorization:`Bearer ${t}`}}).then(l=>{x(e)}).catch(l=>{p()})};function V(e){_.value?g.value&&y.value?o(g.value,y.value,e,!0):c.value?o("file_type",c.value,e):w.value&&o("user",w.value,e):u.value===""?z(e):u.value==="approved"?o("status","approved",e):u.value==="pending"?o("status","pending",e):u.value==="rejected"&&o("status","rejected",e),j.value&&C(F.value,e)}return{getUsersList:D,getFileList:z,FilterFiles:o,updateFileStatus:S,PaginateFile:V,deleteFiles:L,updateFileInformation:I,searchFiles:C,search:j,fileList:r,loading:s,filter:u,filesNumber:v,otherFilter:_,fileType:c,userId:w,startDate:g,endDate:y,showEditPopUpId:m,editFileData:A,searchValue:F}});export{H as u};
