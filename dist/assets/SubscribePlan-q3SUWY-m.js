import{x as m,z as v,r as o,V as r,S as i}from"./index-u-RSwE93.js";import{a as s}from"./axios-L6U4YIEh.js";const x=m("subscribePlan",()=>{let l=v(),a=o(""),n=o(!1),u=o(!1);function p(e,t){let f=r.get("jwt");s.post("https://impactstudio.pythonanywhere.com/api/user/subscribe/",{plan:e,renewal_period:t},{withCredentials:!0,headers:{Authorization:`Bearer ${f}`}}).then(c=>{const w=c.data.redirect_url;window.open(w,"_self").focus()}).catch(c=>{i.fire({icon:"error",title:"خطأ...",text:"حدث خطأ، يرجى المحاولة لاحقًا!"})})}function h(){if(a.value!=="basic"){let e=r.get("jwt");s.post("https://impactstudio.pythonanywhere.com/api/user/delete_subscription/",{withCredentials:!0,headers:{Authorization:`Bearer ${e}`}}).then(t=>{}).catch(t=>{i.fire({icon:"error",title:"خطأ...",text:"حدث خطأ، يرجى المحاولة لاحقًا!"})}).finally(()=>{})}}function b(){let e=r.get("jwt");e&&s.get("https://impactstudio.pythonanywhere.com/api/user/get_subscription/",{withCredentials:!0,headers:{Authorization:`Bearer ${e}`}}).then(t=>{//! assing plan to variable
t.data.subscription&&(a.value=t.data.subscription.plan),t.data.payments&&t.data.payments.length>0&&(n.value=!0),t.data.subscription?(t.data.subscription.active&&(a.value=t.data.subscription.plan,n.value=t.data.subscription.active),!t.data.subscription.active&&t.data.payments.length>0):u.value=!0}).catch(t=>{i.fire({icon:"error",title:"خطأ...",text:"حدث خطأ، يرجى المحاولة لاحقًا!"})})}function d(){let e=r.get("jwt");s.get("https://impactstudio.pythonanywhere.com/api/user/activate_basic/",{withCredentials:!0,headers:{Authorization:`Bearer ${e}`}}).then(t=>{i.fire({icon:"success",title:"تم الاشتراك بنجاح!",text:"لقد تم اشتراكك بنجاح."}).then(()=>{l.push("/chat")})}).catch(t=>{i.fire({icon:"error",title:"خطأ...",text:"حدث خطأ، يرجى المحاولة لاحقًا!"})})}return{subscribe:p,deleteSubscribe:h,getSubscribe:b,subscribeFree:d,subscribePlan:a,active:n,previousSub:u}});export{x as u};
